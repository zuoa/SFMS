<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="特性进度">
	<meta name="author" content="y00486">

	<title>创建任务</title>

	<!-- Bootstrap Core CSS -->
	<link href="{{ static_url("css/bootstrap.min.css") }}" rel="stylesheet">

	<!-- Custom CSS -->
	<style>
		body {
			color: #808080;
			background-color:#FEFEFE;
		}

		.title-header{
			background-color:#EEE;
			padding-top:50px;
			padding-bottom:50px;
			border-bottom:1px solid #FFF;
			margin-bottom:50px;
		}
	</style>

	<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="http://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
        <script src="http://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

    </head>

    <body>

    	<header class="title-header">
    		<div class="container">
    			<div class="row">
    				<div class="col-lg-12">
    					<h1>{{feature_name}}</h1>
                        <h4>{{feature_desc}}</h4>
    				</div>
    			</div>
    		</div>
    	</header>
    	<!-- Page Content -->
    	<div class="container">
    		<div class="row">
    			<div class="table-responsive">
    				<table class="table" id="table_tasks" data-id="{{feature_id}}">
    					<thead>
    						<tr>
    							<th style="width: 20%">类型</th>
                                <th style="width: 12%">进度</th>
    							<th style="width: 20%">责任人</th>
    							<th style="width: 20%">优先级</th>
    							<th style="width: 28%">操作</th>
    						</tr>
    					</thead>
    					<tbody>

                            {% for t in tasks %}
                            <tr>
                                <td  class="device_type"><span class="task-device">{{t['device']}}</span></td>
                                <td><div class="input-group"><input type="text" class="form-control task-progress" value="{{t['progress']}}"><span class="input-group-addon">%</span></div></td>
                                <td>
                                    <select class="form-control task-owner">
                                        {{{{t['owner_option']}}}}
                                    </select>
                                </td>
                                <td>
                                    <select class="form-control task-priority">
                                        {{{{t['priority_option']}}}}
                                    </select>
                                </td>
                                <td>
                                    <button type="button" class="btn btn-default">
                                        <span class="glyphicon glyphicon-remove"></span> 删除
                                    </button>
                                </td>
                            </tr>

                            {% end %}

    					</tbody>
    				</table>

    			</div>


    			<button type="button" id="btn_save" class="btn btn-primary col-lg-2 col-lg-offset-0">保存</button>
    		</div>

    		<!-- /.row -->

    	</div>
    	<!-- /.container -->

    	<!-- jQuery Version 1.11.0 -->
    	<script src="{{ static_url("js/jquery-1.11.0.js") }}"></script>

    	<!-- Bootstrap Core JavaScript -->
    	<script src="{{ static_url("js/bootstrap.min.js") }}"></script>

    	<script type="text/javascript">


    		$("#btn_save").click(function()
    		{
    			var tasks = [];
    			$("#table_tasks tbody tr").each(function(){ 
    				var t = {};
    				t["device"] = $(this).find(".task-device").text();

    				t["owner"] = $(this).find(".task-owner").val();
                    t["progress"] = $(this).find(".task-progress").val().trim();

    				t["priority"] = $(this).find(".task-priority").val();

    				tasks.push(t);

    			});


    			$.post("/f/" + $("#table_tasks").data("id") + "/edit", 
    			{
    				tasks:JSON.stringify(tasks)
    			}, 
    			function(data) {
    				

    			});

    		});
    	</script>

    </body>

    </html>
